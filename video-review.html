<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÄÃ¡nh giÃ¡ Video - Contents Helper</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="video-review.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <div class="review-container">
        <!-- í—¤ë” -->
        <header class="review-header">
            <button class="back-button" onclick="goBack()">
                <span class="back-icon">â†</span>
            </button>
            <div class="review-progress">
                <div class="progress-info">
                    <span class="progress-text">HÃ´m nay: <span id="todayReviewed">0</span>/<span id="todayTarget">20</span></span>
                    <span class="streak-info">ğŸ”¥ <span id="reviewStreak">0</span></span>
                </div>
                <div class="progress-bar-slim">
                    <div class="progress-fill-slim" id="reviewProgressFill"></div>
                </div>
            </div>
            <div class="points-earned">
                <span class="points-icon">â­</span>
                <span class="points-value">+<span id="earnedPoints">0</span></span>
            </div>
        </header>

        <!-- ë¹„ë””ì˜¤ ë·°ì–´ -->
        <div class="video-viewer" id="videoViewer">
            <!-- ë¡œë”© ìƒíƒœ -->
            <div class="loading-state" id="loadingState">
                <div class="spinner-large"></div>
                <p>Äang táº£i video...</p>
            </div>

            <!-- ë¹„ë””ì˜¤ í”Œë ˆì´ì–´ -->
            <div class="video-player" id="videoPlayer" style="display: none;">
                <video id="reviewVideo" autoplay playsinline loop crossorigin="anonymous" preload="auto" controls></video>
                
                <!-- ë¹„ë””ì˜¤ ì •ë³´ ì œê±° - ì˜ìƒë§Œ í‘œì‹œ -->
            </div>

            <!-- ë¹ˆ ìƒíƒœ -->
            <div class="empty-state" id="emptyState" style="display: none;">
                <div class="empty-icon">ğŸ¬</div>
                <h3>KhÃ´ng cÃ²n video Ä‘á»ƒ Ä‘Ã¡nh giÃ¡</h3>
                <p>Báº¡n Ä‘Ã£ Ä‘Ã¡nh giÃ¡ táº¥t cáº£ video cá»§a cÃ´ng ty!</p>
                <button class="btn btn-primary" onclick="goBack()">Quay láº¡i trang chÃ­nh</button>
            </div>
        </div>

        <!-- í•˜ë‹¨ ì»¨íŠ¸ë¡¤ ì˜ì—­ -->
        <div class="bottom-controls" id="bottomControls">
            <div class="controls-content">
                <!-- ë³„ì  í‰ê°€ -->
                <div class="star-rating-container" id="starRatingContainer">
                    <div class="star-rating" id="starRating">
                        <span class="star" data-rating="1">â­</span>
                        <span class="star" data-rating="2">â­</span>
                        <span class="star" data-rating="3">â­</span>
                        <span class="star" data-rating="4">â­</span>
                        <span class="star" data-rating="5">â­</span>
                    </div>
                    <p class="rating-hint" id="ratingHint">Xem Ã­t nháº¥t 3 giÃ¢y Ä‘á»ƒ Ä‘Ã¡nh giÃ¡</p>
                </div>
                
                <!-- ì´ë¯¸ í‰ê°€ëœ ë©”ì‹œì§€ (ìˆ¨ê¹€) -->
                <div class="already-reviewed-container" id="alreadyReviewedContainer" style="display: none;">
                    <p class="already-reviewed-message">Báº¡n Ä‘Ã£ Ä‘Ã¡nh giÃ¡ video nÃ y</p>
                </div>
                
                <!-- ë²„íŠ¼ ê·¸ë£¹ -->
                <div class="control-buttons">
                    <button class="control-btn home-btn" onclick="goBack()" title="Vá» trang chá»§">
                        <svg viewBox="0 0 24 24" width="24" height="24">
                            <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" fill="currentColor"/>
                        </svg>
                        <span>Trang chá»§</span>
                    </button>
                    
                    <button class="control-btn next-btn" id="nextVideoBtn" onclick="nextVideo()" title="Video tiáº¿p theo">
                        <svg viewBox="0 0 24 24" width="24" height="24">
                            <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z" fill="currentColor"/>
                        </svg>
                        <span>Tiáº¿p theo</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ë‹¤ìŒ ë¹„ë””ì˜¤ í”Œë¡œíŒ… ë²„íŠ¼ -->
    <button class="floating-next-btn" id="floatingNextBtn" onclick="nextVideo()" title="Video tiáº¿p theo">
        <svg viewBox="0 0 24 24" width="30" height="30">
            <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z" fill="white"/>
        </svg>
    </button>

    <!-- í¬ì¸íŠ¸ íšë“ ì• ë‹ˆë©”ì´ì…˜ -->
    <div class="points-animation" id="pointsAnimation">
        <span class="animated-points">+<span id="animatedPointsValue">0</span></span>
    </div>

    <!-- ì—°ì† í‰ê°€ ì• ë‹ˆë©”ì´ì…˜ -->
    <div class="streak-animation" id="streakAnimation">
        <div class="streak-fire">ğŸ”¥</div>
        <div class="streak-text">ÄÃ¡nh giÃ¡ liÃªn tiáº¿p!</div>
    </div>

    <!-- ì„±ê³µ/ì˜¤ë¥˜ í† ìŠ¤íŠ¸ -->
    <div class="toast success-toast" id="successToast">
        <span class="toast-icon">âœ…</span>
        <span class="toast-message"></span>
    </div>

    <div class="toast error-toast" id="errorToast">
        <span class="toast-icon">âš ï¸</span>
        <span class="toast-message"></span>
    </div>

    <script src="config.js"></script>
    <script src="video-review-v3-fixed.js"></script>
    <script>
        // í‰ê°€ëœ ë¹„ë””ì˜¤ ì²˜ë¦¬ë¥¼ ìœ„í•œ ê¸€ë¡œë²Œ í•¨ìˆ˜
        window.showReviewedVideoUI = function() {
            const starContainer = document.getElementById('starRatingContainer');
            const reviewedContainer = document.getElementById('alreadyReviewedContainer');
            
            if (starContainer) starContainer.style.display = 'none';
            if (reviewedContainer) reviewedContainer.style.display = 'block';
        };
        
        // ë¯¸í‰ê°€ ë¹„ë””ì˜¤ UI ë³µì›
        window.showUnreviewedVideoUI = function() {
            const starContainer = document.getElementById('starRatingContainer');
            const reviewedContainer = document.getElementById('alreadyReviewedContainer');
            
            if (starContainer) starContainer.style.display = 'block';
            if (reviewedContainer) reviewedContainer.style.display = 'none';
            
            // ë³„ì  ì´ë²¤íŠ¸ ì¬ì„¤ì •
            if (typeof setupStarRating === 'function') {
                setupStarRating();
            }
        };
    </script>
</body>
</html>